# 数据库设计

> 数据库生命周期：分析、概念设计、逻辑和物理设计、实施、测试、操作维护

## 分析

### 分析的步骤

- 分析组织
- 定义任何问题，可能行或者约束
- 定义目标
- 同意范围

### 分析说明

- 分析要设计的数据库相关产品背景
- 产品应用场景
- 确定数据库实现目标
- 确定需求

## 概念设计

> 将之前的需求分析结果转换为数据实现方案
>
> 目的是：基于之前确定的需求，构建概念模型，将一些文字理念转化为物理模型

### 实体关系模型

#### 实体和属性

- 实体为想要保留信息的人、地点或者事务。将之前业务场景模型化的结果。
- 属性为实体的补充信息
	- 可以理解为实体为一个表，或者表中一条数据
	- 属性为表中的每个字段信息
- 比如医院信息场景下：
	- 患者为实体
		- 姓名、年龄、诊断等为患者实体的属性
	- 可以有多个实体，比如患者信息、医生信息、护士信息、医嘱信息等
		- 之间的关系，有一对一、一对多、多对多等

#### 制定实体关系图

- 将业务场景中的实体列出来
- 画出各个实体之间的关联关系
- 在根据实体属性补充实体内容

## 逻辑和物理设计

> 将之前的概念设计，落实到选择数据库，实现表、字段设计

### 步骤

- 每个实体为数据库表
- 每个属性为该表的字段

### 要求

- 表进行规范化设计（避免数据冗余、提高数据完整性，在数据冗余和效率中平衡）
	- 数据库规范化

### 常见的错误

- 将不相关的数据保留在不通的表中
- 不要存储可以计算的值
- 你的设计是否满足已经分析的所有条件？在急于创建实体关系图的时候，可能会忽略一些条件，实体关系图通常比让缺失的规则更能使利益相关者发现错误的规则。业务逻辑与数据库逻辑一样重要，并且很可能被忽略
- 是否已正确选择了将要成为字段名称的属性？字段应明确命名，字段命名有规范最好能表达属性意思
- 不要建立太多的关系，几乎可以将系统中的每个表关联在一起，但是没有必要这样做
- 相反，您照顾到所有关系了吗？实体关系图中的所有关系在表结构中是否显示为公共字段？你涵盖所有关系了吗？是否将所有多对多关系通过一个相交实体分解为两个一对多关系？
- 您是否列出了所有限制条件？比如邮件地址中必须有@符号，儿童年龄小于20岁等
- 字段大小合适，较大的表访问较慢，并且不必要的[BLOB](https://mariadb.com/kb/en/blob/)，[TEXT](https://mariadb.com/kb/en/text/)和[VARCHAR](https://mariadb.com/kb/en/varchar/) 字段导致记录和表碎片化。

## 实施

1. 安装DBMS。
2. 根据硬件，软件和使用条件调整设置变量。
3. 创建数据库和表。
4. 加载数据。
5. 设置用户和安全性。
6. 实施备份机制。

## 测试

> 测试数据的性能，安全性和完整性的阶段

1. 测试性能
2. 测试安全性
3. 测试数据完整性
4. 根据测试微调参数或修改逻辑或物理设计。

## 操作

1. 将数据库的操作移交给用户。
2. 根据用户发现的问题进行任何最终更改。

## 维护

- 常规维护，例如维护索引，优化表，添加和删除用户以及更改密码，以及在发生故障时备份和还原备份
- 维护指标
- 维护表格
- 维护用户
- 修改密码
- 后备
- 恢复备份
- 更改设计以满足新要求